---
title: System Architecture
description: Detailed technical architecture of the FOS platform including smart contracts, backend services, and frontend applications.
---

# System Architecture

This page provides a comprehensive overview of the FOS platform architecture, including component interactions, data flows, and deployment topology.

## Overview

The FOS architecture follows a modular design separating concerns across three primary layers:

**User Layer:**
- User Wallet
- Web Browser

**Frontend Layer:**
- Landing Website
- Main Application
- Admin Dashboard

**Service Layer:**
- REST API
- Merkle Service
- Notification Service
- Analytics

**Data Layer:**
- PostgreSQL
- Redis Cache
- IPFS Gateway

**Blockchain Layer:**
- RPC Provider
- The Graph Indexer
- Smart Contracts

---

## Components

### Smart Contracts

The on-chain component suite handles all trustless operations:

| Contract | Purpose | Key Functions |
|----------|---------|---------------|
| **FOSToken** | Core NFT implementation | `mint()`, `burn()`, `tokenURI()` |
| **MerkleVerifier** | Whitelist validation | `verify()`, `updateRoot()` |
| **PrizePool** | Reward distribution | `claim()`, `deposit()`, `distribute()` |
| **AdminRegistry** | Access control | `grantRole()`, `revokeRole()` |

```solidity
// Simplified contract interaction flow
interface IFOSToken {
    function mint(
        address to,
        bytes32[] calldata merkleProof
    ) external payable returns (uint256 tokenId);
    
    function balanceOf(address owner) external view returns (uint256);
    
    function tokenURI(uint256 tokenId) external view returns (string memory);
}
```

### Landing Website

Public-facing entry point for user acquisition and initial interactions:

**Responsibilities:**
- Marketing and information display
- Wallet connection and address capture
- Whitelist status checking
- Free mint initiation
- Prize discovery and exploration

**Tech Stack:**
- Next.js 15 with App Router
- TailwindCSS for styling
- wagmi/viem for Web3 interactions
- Vercel for deployment

### Main Application

Authenticated user dashboard for managing mints and claims:

**Modules:**

| Module | Description |
|--------|-------------|
| **Dashboard** | Portfolio view, mint history, live status indicators |
| **Mint** | Guided flows for whitelist, public, and free mint phases |
| **Prize** | Claim submission, verification, settlement tracking |
| **Admin** | Role-gated controls for phases, parameters, emergency ops |

### Off-chain Services

Backend services supporting the platform:

| Service | Description |
|---------|-------------|
| **Express API** | Core REST API server |
| **Merkle Generator** | Creates Merkle trees from allowlist |
| **Notifications** | Email and push notification delivery |
| **Indexer Service** | Blockchain event indexing |
| **Analytics Pipeline** | Usage tracking and reporting |

---

## Data Flow

### Whitelist Registration

1. **User Submission** - User connects wallet and submits address via landing page
2. **Backend Processing** - Address added to allowlist database with timestamp and metadata
3. **Merkle Generation** - Periodic job generates new Merkle tree from eligible addresses
4. **Root Update** - Admin transaction updates Merkle root in smart contract

### Minting Flow

1. User connects wallet via Frontend
2. Frontend requests proof from API: `GET /api/proof?address=0x...`
3. API generates Merkle Proof and returns `proof[]`
4. Frontend calls contract: `mint(proof)`
5. Contract verifies proof and mints NFT
6. Contract returns TokenId
7. Frontend shows success to user

### Prize Distribution

1. **Funding**: Admin deposits prize pool funds to contract
2. **Selection**: VRF request triggers random winner selection
3. **Notification**: Eligible winners notified via email/push
4. **Claims**: Winners submit claim transactions
5. **Settlement**: Contract transfers prizes to claimants

---

## Infrastructure

### Deployment Topology

| Layer | Service | Purpose |
|-------|---------|---------|
| **CDN Edge** | Cloudflare | Global content delivery |
| **Compute** | Vercel Edge | Frontend hosting |
| **Compute** | Railway Containers | Backend services |
| **Storage** | Supabase PostgreSQL | Primary database |
| **Storage** | Upstash Redis | Caching layer |
| **Storage** | Pinata IPFS | Decentralized storage |
| **Blockchain** | Alchemy RPC | Ethereum node access |
| **Blockchain** | The Graph Network | Indexing and queries |

### Environment Configuration

| Environment | Purpose | Chain | RPC Provider |
|-------------|---------|-------|--------------|
| **Development** | Local testing | Hardhat | localhost:8545 |
| **Testnet** | QA & staging | Sepolia | Alchemy Sepolia |
| **Production** | Live platform | Ethereum Mainnet | Alchemy Mainnet |

---

## Security Architecture

### Defense in Depth

**Perimeter Layer:**
- Web Application Firewall
- DDoS Protection

**Application Layer:**
- JWT Authentication
- Rate Limiting
- Input Validation

**Smart Contract Layer:**
- Access Control
- Reentrancy Guards
- Emergency Pause

### Key Management

- **Hot Wallets**: Server-side signing for automated operations
- **Cold Wallets**: Multi-sig for treasury and admin functions
- **HSM**: Hardware security for production key storage

---

> **Info**: For smart contract implementation details, see [Smart Contracts](/docs/smart-contracts).
